"""
Routes and views for the flask application.
"""

from flask import render_template
from MSPS import app
from MSPS.MusicCompare import *
from flask import Flask, jsonify


@app.route('/compare', methods=['GET'])
def calculateSimilarity():
	mcompare = MusicCompare()
	resultsDict = mcompare.compare("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><!DOCTYPE score-partwise PUBLIC \"-//Recordare//DTD MusicXML 0.6 Partwise//EN\" \"http://www.musicxml.org/dtds/partwise.dtd\"><score-partwise><work><work-title>Christe_redemptor_IV</work-title></work><identification><creator type=\"composer\">Anonymous</creator><encoding><software>SharpEye Music Reader 2</software><encoding-description>Scanning program</encoding-description></encoding></identification><part-list><score-part id=\"P1\"><part-name>Part_1</part-name></score-part><score-part id=\"P2\"><part-name>Part_2</part-name></score-part></part-list><part id=\"P1\"><measure number = \"1\"><attributes><divisions>6</divisions><key><fifths>0</fifths></key><time symbol=\"normal\"><beats>3</beats><beat-type>2</beat-type></time><staves>1</staves><clef number = \"1\"><sign>G</sign><line>2</line><clef-octave-change>0</clef-octave-change></clef></attributes><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"2\"><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"3\"><note><pitch><step>G</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"4\"><note><pitch><step>D</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"5\"><note><pitch><step>F</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>C</step><alter>1</alter><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><accidental>sharp</accidental><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"6\"><note><pitch><step>D</step><octave>4</octave></pitch><duration>24</duration><voice>1</voice><type>whole</type><notations></notations></note><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note></measure><!--===================================================--><measure number = \"7\"><note><pitch><step>C</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"8\"><note><pitch><step>G</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>A</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"9\"><note><pitch><step>A</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>B</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>down</stem><notations></notations></note><note><pitch><step>A</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><alter>1</alter><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><accidental>sharp</accidental><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"10\"><note><pitch><step>A</step><octave>4</octave></pitch><duration>24</duration><voice>1</voice><type>whole</type><notations></notations></note><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note></measure><!--===================================================--><measure number = \"11\"><print new-system=\"yes\"/><note><pitch><step>A</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>B</step><alter>-1</alter><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><accidental>flat</accidental><stem>down</stem><notations></notations></note><note><pitch><step>A</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"12\"><note><pitch><step>G</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"13\"><note><pitch><step>G</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"14\"><note><pitch><step>F</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>6</duration><tie type=\"start\"/><voice>1</voice><type>quarter</type><stem>up</stem><notations><tied type=\"start\"/></notations></note></measure><!--===================================================--><measure number = \"15\"><note><pitch><step>C</step><octave>4</octave></pitch><duration>3</duration><tie type=\"stop\"/><voice>1</voice><type>eighth</type><stem>up</stem><beam number=\"1\">begin</beam><notations><tied type=\"stop\"/></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>3</duration><voice>1</voice><type>eighth</type><stem>up</stem><beam number=\"1\">end</beam><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>9</duration><voice>1</voice><type>quarter</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>3</duration><voice>1</voice><type>eighth</type><stem>up</stem><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>B</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"16\"><note><pitch><step>C</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"17\"><note><pitch><step>E</step><octave>4</octave></pitch><duration>8</duration><voice>1</voice><type>half</type><time-modification><actual-notes>3</actual-notes><normal-notes>2</normal-notes><normal-type>quarter</normal-type></time-modification><stem>up</stem><notations><tuplet type=\"start\"/></notations></note><note><pitch><step>F</step><octave>4</octave></pitch><duration>4</duration><voice>1</voice><type>quarter</type><time-modification><actual-notes>3</actual-notes><normal-notes>2</normal-notes></time-modification><stem>up</stem><notations><tuplet type=\"stop\"/></notations></note><note><pitch><step>G</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"18\"><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>A</step><octave>4</octave></pitch><duration>9</duration><voice>1</voice><type>quarter</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>4</octave></pitch><duration>3</duration><voice>1</voice><type>eighth</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"19\"><note><pitch><step>F</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>C</step><alter>1</alter><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><accidental>sharp</accidental><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"20\"><note><pitch><step>D</step><octave>4</octave></pitch><duration>36</duration><voice>1</voice><type>whole</type><dot/><notations></notations></note><barline><bar-style>light-heavy</bar-style></barline></measure><!--===================================================--></part><part id=\"P2\"><measure number = \"1\"><attributes><divisions>6</divisions><key><fifths>0</fifths></key><time symbol=\"normal\"><beats>3</beats><beat-type>2</beat-type></time><staves>1</staves><clef number = \"1\"><sign>G</sign><line>2</line><clef-octave-change>-1</clef-octave-change></clef></attributes><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note><note><pitch><step>C</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"2\"><note><pitch><step>G</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>B</step><alter>-1</alter><octave>3</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><accidental>flat</accidental><stem>down</stem><notations></notations></note><note><pitch><step>A</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"3\"><note><pitch><step>B</step><alter>-1</alter><octave>3</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><accidental>flat</accidental><stem>down</stem><notations></notations></note><note><pitch><step>A</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"4\"><note><pitch><step>F</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>B</step><alter>-1</alter><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><accidental>flat</accidental><stem>down</stem><notations></notations></note></measure><!--===================================================--><measure number = \"5\"><note><pitch><step>A</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"6\"><note><pitch><step>D</step><octave>3</octave></pitch><duration>24</duration><voice>1</voice><type>whole</type><notations></notations></note><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note></measure><!--===================================================--><measure number = \"7\"><note><pitch><step>E</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>A</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"8\"><note><pitch><step>B</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>down</stem><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>down</stem><notations></notations></note><note><pitch><step>B</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>down</stem><notations></notations></note></measure><!--===================================================--><measure number = \"9\"><note><pitch><step>C</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>down</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>down</stem><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>down</stem><notations></notations></note><note><pitch><step>B</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>down</stem><notations></notations></note></measure><!--===================================================--><measure number = \"10\"><note><pitch><step>A</step><octave>3</octave></pitch><duration>24</duration><voice>1</voice><type>whole</type><notations></notations></note><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note></measure><!--===================================================--><measure number = \"11\"><print new-system=\"yes\"/><note><pitch><step>A</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>4</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>down</stem><notations></notations></note><note><pitch><step>C</step><octave>4</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>down</stem><notations></notations></note></measure><!--===================================================--><measure number = \"12\"><note><pitch><step>B</step><alter>-1</alter><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><accidental>flat</accidental><stem>down</stem><notations></notations></note><note><pitch><step>A</step><octave>3</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"13\"><note><pitch><step>B</step><alter>-1</alter><octave>3</octave></pitch><duration>18</duration><voice>1</voice><type>half</type><dot/><accidental>flat</accidental><stem>down</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"14\"><note><pitch><step>A</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"15\"><note><pitch><step>F</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>G</step><octave>3</octave></pitch><duration>9</duration><voice>1</voice><type>quarter</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>3</duration><voice>1</voice><type>eighth</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>D</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"16\"><note><pitch><step>C</step><octave>3</octave></pitch><duration>36</duration><voice>1</voice><type>whole</type><dot/><notations></notations></note></measure><!--===================================================--><measure number = \"17\"><note><rest/><duration>12</duration><voice>1</voice><type>half</type><notations></notations></note><note><pitch><step>C</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>3</octave></pitch><duration>9</duration><voice>1</voice><type>quarter</type><dot/><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>3</duration><voice>1</voice><type>eighth</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"18\"><note><pitch><step>G</step><octave>3</octave></pitch><duration>24</duration><voice>1</voice><type>whole</type><notations></notations></note><note><pitch><step>D</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"19\"><note><pitch><step>D</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>C</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note><note><pitch><step>F</step><octave>3</octave></pitch><duration>6</duration><voice>1</voice><type>quarter</type><stem>up</stem><notations></notations></note><note><pitch><step>E</step><octave>3</octave></pitch><duration>12</duration><voice>1</voice><type>half</type><stem>up</stem><notations></notations></note></measure><!--===================================================--><measure number = \"20\"><note><pitch><step>D</step><octave>3</octave></pitch><duration>36</duration><voice>1</voice><type>whole</type><dot/><notations></notations></note><barline><bar-style>light-heavy</bar-style></barline></measure><!--===================================================--></part></score-partwise>", "CS")
	
	return jsonify(resultsDict)